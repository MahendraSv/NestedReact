/**
 * React-Backbone.Glue 0.1.1 <https://github.com/Volicon/react-backbone.glue>
 * (c) 2015 Vlad Balin & Volicon
 * Released under MIT @license
 */
!function(t,e){"object"==typeof exports?module.exports=e(require("backbone"),require("react")):"function"==typeof define&&define.amd?define(["backbone","react"],e):t.React=e(t.Backbone,t.React)}(this,function(t,e){function n(){this.forceUpdate()}function i(t){for(var e=null,n=t.mixins.length-1;n>=0;n--){var i=t.mixins[n];i.attributes&&(e||(e={}),Object.assign(e,i.attributes))}return t.attributes&&(e?Object.assign(e,t.attributes):e=t.attributes),e}function o(){var t=u.call(arguments);return t.unshift(this),new c(t)}Object.assign||(Object.assign=function(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var s=Object.keys(Object(o)),r=0,a=s.length;a>r;r++){var u=s[r],c=Object.getOwnPropertyDescriptor(o,u);void 0!==c&&c.enumerable&&(n[u]=o[u])}}return n});var s={componentDidMount:function(){var t=this.props,e=this.listenToProps;for(var i in e){var o=t[i];o&&this.listenTo(o,e[i],n)}},componentWillUnmount:function(){var t=this.props,e=this.listenToProps;for(var n in e){var i=t[n];i&&this.stopListening(i)}}},r={listenToState:"change",getInitialState:function(){return new this.Model},componentDidMount:function(){var t=this.listenToState;t&&this.listenTo(this.state,t,n)},componentWillUnmount:function(){this.stopListening(this.state),this.state=null}},a=e.createClass;e.createClass=function(n){n.mixins||(n.mixins=[]);var u=i(n);if(u){var c=n.Model||t.Model;n.Model=c.extend({defaults:u})}n.Model&&n.mixins.unshift(r),n.listenToProps&&n.mixins.unshift(s),(n.Model||n.listenToProps)&&n.mixins.push(t.Events);var l=a.call(e,n);return l.createView=o,l};var u=Array.prototype.slice;e.createView=function(){return new c(arguments)};var c=t.View.extend({initialize:function(t){this._args=t},element:null,setElement:function(){return this.element&&(this.element=null,this.unmountComponent()),t.View.prototype.setElement.apply(this,arguments)},component:null,unmountComponent:function(){this.component&&(this.component.trigger&&this.stopListening(this.component),e.unmountComponentAtNode(this.el),this.component=null)},render:function(){this.element||(this.element=e.createElement.apply(e,this._args));var t=!this.component;this.component=e.render(this.element,this.el),t&&this.component.trigger&&this.listenTo(this.component,"all",function(){this.trigger.apply(this,arguments)})},dispose:function(){this.unmountComponent(),t.View.prototype.dispose.apply(this,arguments)}});return e.subview=e.createClass({displayName:"BackboneView",propTypes:{View:e.PropTypes.func.isRequired,options:e.PropTypes.object},render:function(){return e.DOM.div({ref:"subview",className:this.props.className})},componentDidMount:function(){var t=this.refs.subview.getDOMNode(),e=this.props,n=this.view=e.options?new e.View(e.options):new e.View;n.setElement(t),n.render()},componentDidUpdate:function(){this.view.render()},componentWillUnmount:function(){var t=this.view;t.dispose&&t.dispose()}}),e});
